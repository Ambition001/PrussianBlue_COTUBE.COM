<!DOCTYPE html>
<html style="height:100%" lang="en" >
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>View Comic</title>

    <!-- TODO:
            Do not allow guest like, favorite or comment
            Display comment 20 per pages(Delete button next to own comments)
            Add next & prev arrow if series
            Get comicid from cookie and load the page
            Favorite functionality
            Like front-end done, back-end to be done -->

    <link rel='stylesheet' href='http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css'>
    <link rel="stylesheet" href="./css/style.css">
    <script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
    <script src="./js/js.cookie.js"></script>
    <script src="./js/viewComics.js"></script>
    <script src="./js/jumpFunction.js"></script>


</head>

<body>
    <div id = "wrap">
        <div class="regbar">
            <div class = "regbar-left" style="width:30%">
                    <img src = "./img/CoTube-logo.png" style = "margin-top:0px;" width = "125px" height = "50px" onclick="gohome()">
            </div>
            <div class = "regbar-mid" align="center">
                <input type="text" class="search_bar" name="search_word" id="search_word" size="35" placeholder="Input for searching...">
                <select class="selectType" id="search_by" name="search_by">
                    <option value="keyword">By Keyword</option>
                    <option value="author">By Author</option>
                </select>
                <input type="image" src = "./img/search.png" style = "margin-right:3px; width:35px; height:35px" onclick="searchResult()"/>
            </div>

            <div class = "regbar-right" style = "margin-top:7px;">
                <input type="image" src = "./img/create.png" id="create" style = "margin-right:3px;" width = "35px" height = "35px" onclick="goCreate();">
                <input type="image" src = "./img/home.png" id="home" style = "margin-right:3px;" width = "35px" height = "35px" onclick="gohome();">
                <input type="image" src = "./img/message.png" id="message" style = "margin-right:3px;"  height = "35px" onclick="goMessage();">
                <input type="image" src = "./img/profile.png" id="profile" style = "margin-right:3px;"  height = "35px" onclick="goProfile();">
                <input type="image" src = "./img/setting.png" id="setting" style = "margin-right:3px;"  height = "35px" onclick="gotosetting();">
                <input type="image" src = "./img/sign-in.png" id="login" style = "margin-right:3px;" width = "35px" height = "35px" onclick="login();">
                <input type="image" src = "./img/sign-out.png" id="signout" style = "margin-right:3px;" width = "35px" height = "35px" onclick="logout();">
            </div>
        </div>
    </div>

    <div>
        <br>
        <table align="center" style="text-align: center;">
            <tr>
                <td colspan="3">
                    <h1 id="comictitle">Comic Title</h1>
                </td>
            </tr>
            <tr>
                <td>
                    <span style="font-size:20px;color:gray;margin-left:23px;" id="comicviewnum">Views:8964</span>
                </td>
                <td>
                    <span style="font-size:20px;display:inline;margin-left:10px;">Created by</span>
                    <a  style="display:inline;font-size:20px;" id="comicauthor"></a>
                </td>
                <td>
                    <img src = "" style = "display:inline;margin-left:5px;" width = "45px" height = "45px" id="authorimg">
                </td>
            </tr>
            <tr>
                <td colspan="3">
                    <button type="button" class = "deleteButton" style = "display:none;" id="delete">Delete</button>
                </td>
            </tr>
        </table>
        <input type="hidden" id = "comicid" value = "3455">
        <img src="" style="display:block;margin:0 auto;margin-top:20px;" id="comicimg">
        <table align="center" id = "likefavtb">
            <tr>
                <td align="center" style="width:150px;">
                    <input type="image" src = "./img/like-gray.png" width = "40px" id="likebtn" onclick="toggleLike();">
                </td>
                <td align="center" style="width:150px;">
                    <input type="image" src = "./img/star-empty.png" width = "40px" id="favbtn">
                </td>
            </tr>
            <tr>
                <td align="center">
                    <span id="likenumber"></span>
                </td>
                <td align="center"></td>
            </tr>
        </table>
    </div>
    <br>
    <br>
    <table align="center" width = "65%">
        <tr>
            <td colspan="2" id="comicdescription"></td>
        </tr>
        <tr>
            <td>
                <h2 style="margin-left:0px;">Comments(23)</h2>
            </td>
        </tr>
        <tr id = "comments">
            <td>
                <textarea maxlength = "300" rows="4" cols="88" style="color:black;" placeholder="Enter your comment:" id="commentText"></textarea>
            </td>
            <td>
                <button type="button" class="submitButton" style="height:85px;margin-left:0px;margin-top:0px;" onclick = "postComment();">Post</button>
            </td>
        </tr>
    </table>
    <table width = "65%" align="center">
        <tr>
            <td><span style="margin-left:0px;">Very Interesting comic!!!</span></td>
        </tr>
        <tr>
            <td>
                <span style="margin-left:0px;">#23</span>
                <a href="profile.html" style="float:right;">crazyArtist2048</a>
                <span style="float:right;margin-right:0.5em;">by </span>
                <span style="float:right;color:gray;margin-right:0.5em;">2 min ago</span>
                <input type="image" src = "./img/delete.png" style = "margin-right:5px;float:right;" width = "20px" height = "20px">
                <hr class="style-six">
            </td>
        </tr>
        <tr>
            <td><span style="margin-left:0px;">Gorgeous!</span></td>
        </tr>
        <tr>
            <td>
                <span style="margin-left:0px;">#22</span>
                <a href="profile.html" style="float:right;">solaireOfAstora</a>
                <span style="float:right;margin-right:0.5em;">by </span>
                <span style="float:right;color:gray;margin-right:0.5em;">54 min ago</span>
                <hr class="style-six">
            </td>
        </tr>
    </table>
    <table align="center">
        <tr>
            <td><span style="margin-right:10px;">First</span></td>
            <td><span style="color:dodgerblue;margin-right:10px;">1</span></td>
            <td><span style="margin-right:10px;">2</span></td>
            <td><span style="margin-right:10px;">Last</span></td>
        </tr>
    </table>
    <script>
        if($.cookie('role')=="user"){
            document.getElementById("login").style.display = "none";
        }else{
            document.getElementById("create").style.display = "none";
            document.getElementById("signout").style.display = "none";
            document.getElementById("message").style.display = "none";
            document.getElementById("profile").style.display = "none";
            document.getElementById("setting").style.display = "none";
            document.getElementById("likefavtb").style.display = "none";
            document.getElementById("comments").style.display = "none";
        }

        if($.cookie("role")=="admin"||$.cookie("username")==$("#comicauthor").text()){
            document.getElementById("delete").style.display = "initial";
        }
        
// TODO: ,   description.  comic name,post comic,author,
        document.getElementById("comicid").value = $.cookie("comicId");
        var likenum = likeNumber();
        document.getElementById("likenumber").innerHTML = likenum;
        var info = comicInfo();
        document.getElementById("comicauthor").innerHTML = info.author;
        document.getElementById("comicauthor").onclick = function() {
            authorprofile(info.author);
        }
        document.getElementById("comicviewnum").innerHTML = "Views:"+info.views;
        document.getElementById("comicimg").src = info.path;
        document.getElementById("comicdescription").innerHTML = info.description;        
        document.getElementById("comictitle").innerHTML = comicTitle();
        document.getElementById("authorimg").src = info.authorpath;
        if(info.author==$.cookie("username")){
            document.getElementById("delete").style.display = "block";
        }
        if(checkLike()){
            document.getElementById("likebtn").src = "./img/like-red.png";
        }else{
            document.getElementById("likebtn").src = "./img/like-gray.png";
        }
        



        if(checkFavorite()){
            document.getElementById("favbtn").src = "./img/star.png";
        }else{
            document.getElementById("favbtn").src = "./img/star-empty.png";
        }
// TODO: 
        //Check user and add delete button to comment 
        
        
 
    </script>





    <!-- for popup -->
    <div id="favoritePopup" class="modal">
        <div class="modal-content" style="width: fit-content;">
            <span id="x4" class="close">&times;</span>
            <span style="font-size:20px; line-height:200%">Add To:</span>
            <table class="favoriteTable" >
                <tr>
                    <td>
                        <input type="checkbox" id="myCheck1">1
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="checkbox" id="myCheck2">2
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="checkbox" id="myCheck3">3
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="checkbox" id="myCheck4">4
                    </td>
                </tr>
                <tr>
                    <td style="line-height: 230%; ">
                        <input type="checkbox" id="checkadd">
                        <input id="newList" class="form-control" style="width: auto; margin:0px; display: inline-block" placeholder="input new list name..."/>
                    </td>
                </tr>
                <tr style="margin-top:20px">
                    <td>
                        <button class="kwbtn kwbtn2" id="submitFavorite" style="line-height:120%; position: relative; left: 57%;">Save</button>
                    </td>
                </tr>
            </table>
        </div>
    </div>            
    <script>
        var modalfavorite = document.getElementById('favoritePopup');
        var btnfavorite = document.getElementById("favbtn");
        btnfavorite.onclick = function() {
            modalfavorite.style.display = "block";
        }
        var x4 = document.getElementById("x4");
        x4.onclick = function() {
            modalfavorite.style.display = "none";
        }
        window.onclick = function(event) {
            if (event.target == modalfavorite) {
                modalfavorite.style.display = "none";
            }
        }
    </script>

</body>

</html>
